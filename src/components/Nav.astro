---
// Nav.astro - Main navigation with mobile menu
const navLinks = [
  { href: '/renting', label: 'Renting' },
  { href: '/visa', label: 'Visa' },
  { href: '/business', label: 'Business' },
  { href: '/family', label: 'Family' },
  { href: '/documents', label: 'Documents' },
  { href: '/how-it-works', label: 'How It Works' },
];

const currentPath = Astro.url.pathname;
---

<nav class="bg-[#1B3A5C] text-white sticky top-0 z-50 shadow-md" aria-label="Main navigation">
  <div class="max-w-6xl mx-auto px-6">
    <div class="flex items-center justify-between h-16">

      <!-- Logo -->
      <a href="/" class="flex items-center gap-2 font-heading font-semibold text-lg hover:opacity-90 transition-opacity">
        <span class="text-[#E8913A]">⚖</span>
        <span>Expat Legal <span class="text-[#E8913A]">Vietnam</span></span>
      </a>

      <!-- Desktop nav links -->
      <div class="hidden md:flex items-center gap-6">
        {navLinks.map(link => (
          <a
            href={link.href}
            class={`text-sm font-medium transition-colors hover:text-[#E8913A] ${
              currentPath === link.href ? 'text-[#E8913A]' : 'text-white/80'
            }`}
          >
            {link.label}
          </a>
        ))}
      </div>

      <!-- Desktop CTA button -->
      <a
        href="/book"
        class="hidden md:inline-flex items-center gap-2 bg-[#E8913A] text-white text-sm font-semibold px-4 py-2 rounded-lg hover:bg-amber-500 transition-all duration-200 shadow-sm hover:shadow-md"
      >
        Book a Call
      </a>

      <!-- Mobile hamburger button -->
      <button
        id="mobile-menu-toggle"
        aria-label="Toggle mobile menu"
        aria-expanded="false"
        class="md:hidden flex flex-col gap-1.5 p-2 rounded-lg hover:bg-white/10 transition-colors"
      >
        <span class="block w-5 h-0.5 bg-white transition-all duration-200" id="bar1"></span>
        <span class="block w-5 h-0.5 bg-white transition-all duration-200" id="bar2"></span>
        <span class="block w-5 h-0.5 bg-white transition-all duration-200" id="bar3"></span>
      </button>
    </div>

    <!-- Mobile menu -->
    <div
      id="mobile-menu"
      class="md:hidden hidden pb-4 border-t border-white/10 pt-4"
      aria-hidden="true"
    >
      <div class="flex flex-col gap-1">
        {navLinks.map(link => (
          <a
            href={link.href}
            class={`px-3 py-2.5 rounded-lg text-sm font-medium transition-colors hover:bg-white/10 ${
              currentPath === link.href ? 'text-[#E8913A] bg-white/10' : 'text-white/80'
            }`}
          >
            {link.label}
          </a>
        ))}
        <a
          href="/book"
          class="mt-3 flex items-center justify-center gap-2 bg-[#E8913A] text-white text-sm font-semibold px-4 py-3 rounded-lg hover:bg-amber-500 transition-all duration-200"
        >
          Book a Call →
        </a>
      </div>
    </div>
  </div>
</nav>

<script>
  // Mobile menu toggle - progressive enhancement
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');
  const bar1 = document.getElementById('bar1');
  const bar2 = document.getElementById('bar2');
  const bar3 = document.getElementById('bar3');

  if (toggle && menu) {
    toggle.addEventListener('click', () => {
      const isOpen = menu.classList.toggle('hidden') === false;
      toggle.setAttribute('aria-expanded', String(isOpen));
      menu.setAttribute('aria-hidden', String(!isOpen));

      // Animate hamburger to X
      if (isOpen) {
        bar1?.classList.add('rotate-45', 'translate-y-2');
        bar2?.classList.add('opacity-0');
        bar3?.classList.add('-rotate-45', '-translate-y-2');
      } else {
        bar1?.classList.remove('rotate-45', 'translate-y-2');
        bar2?.classList.remove('opacity-0');
        bar3?.classList.remove('-rotate-45', '-translate-y-2');
      }
    });
  }
</script>
